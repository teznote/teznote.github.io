---
layout: post
title: "INDEX,ROWS: 열에 있는 데이터들을 역순으로 재나열하는 함수식"
updated: 2021-08-18
tags: [excel_formula]
---

어떤 열에 데이터들이 나열되어있고, 다른 열에는 데이터 위 아래를 뒤집어서 역순으로 나열되어 있다고 해보자. 만약 원 데이터의 나열 순서를 바꿨다면, 역순으로 나열되어 있는 열도 다시 작업을 해야하는 경우가 대부분일 것이다.

만일 함수식으로 데이터 역순 나열을 표현할 수 있다면, 원본 데이터 순서 변경만으로도 역순 나열도 자동화될 것이다.

## INDEX, ROWS 함수식 사용

![그림00](/img/excel_formula/formula-0020-00.png)

```excel
= INDEX( 목록범위, ROWS( 변형된목록범위 ))
```
{:.excel}

`목록범위`는 뒤집기를 원하는 원래의 항목들 범위를 지정하면 된다. 문제는 `변형된목록범위`인데, `목록범위`와 지정하는 범위는 동일하지만 상대/절대 참조 모양이 다르다. 위 그림을 보더라도 범위의 앞부분은 상대참조, 뒷부분은 절대참조로 되어있다. 변형된 참조형태로 인해 아래로 복사했을 때, ROWS 에 인수로 적용되는 범위가 달라지게 된다.

ROWS 는 주어진 범위의 열개수를 반환한다. 위 그림으로 보자면, C5 셀의 ROWS 값은 7 이 된다. 이를 INDEX 가 받아서 원래 범위의 7 번째 항목, 즉 제일 마지막 항목을 가져온다. 이 수식을 다른 셀에 복사했을 때 ROWS 값이 예측된다면 이 함수식의 작동원리가 이해가 될 것이다.