---
layout: post
title: "Excel: 소수점 계산할 때 주의할 점"
updated: 2021-08-06
categories: [msoffice_tips]
tags: [msoffice,excel,floating_number]
---

## 엑셀 소수점 계산 문제

![그림00](/img/msoffice/tips/tips-0010.png)

엑셀을 열고 `= 3.3 - 3.2` 라고 수식을 넣어보자. 화면에는 당연한 듯 0.1 이라고 표시가 되지만, 셀의 소수점 자릿수를 늘리다보면 수식의 결과가 이상하다는 것을 알게 된다.

버그는 아니다. **엑셀 소수점 계산에는 정밀도에 오차가 있다**라고 이해하는 것이 좋다.

[MS 도움말](https://docs.microsoft.com/ko-KR/office/troubleshoot/excel/floating-point-arithmetic-inaccurate-result)을 참고해보면 그 이유를 알 수 있다. 요약하면 메모리 물리적 한계로 정확하게 표현가능한 소수점 자릿수에는 한계가 있을 수밖에 없고, 따라서 완벽한 정밀함을 기대할 수 없다는 내용이다. 도움말을 더 읽어보면 소수점 뿐만아니라 아주 큰 수의 계산에 있어서도 오류가 나올 수 있다고 한다.

실무에서 엑셀 작업을 할 땐, 나눗셈을 하여 보통 백만/억 단위로 자릿수를 바꿔 작업하는 경우가 많다. 필연적으로 소수점 이하 자리가 생기는데 일반적으론 큰 문제가 되지 않지만 1원 차이마저 용납할 수 없는 작업이라면 되도록 소수점 이하 자릿수를 만들지 않고 작업하는 것이 좋다.
