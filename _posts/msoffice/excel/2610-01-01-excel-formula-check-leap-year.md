---
layout: post
title: "MOD: 어떤 연도가 윤년인지 아닌지 판별하는 함수식"
updated: 2024-04-22
categories: [excel_formula]
tags: [msoffice,excel,formula,mod,month,date]
---

## 윤년 판별식 사용
```excel
= IF( MOD(연도,400)=0, "윤년", IF( MOD(연도,100)=0, "평년", IF( MOD(연도,4)=0, "윤년", "평년" )))
```
{:.excel}

윤년이 아닌 해를 평년이라 했을 때의 수식이다. 현대의 윤년판별식인 [그레고리력](https://namu.wiki/w/%EA%B7%B8%EB%A0%88%EA%B3%A0%EB%A6%AC%EB%A0%A5)의 윤년 규정을 그대로 함수식으로 옮겨놓은 것이다.

위 함수식에서 `연도` 자리에는 "2022" 처럼 정확히 숫자로 표현된 연도를 넣으면 된다.

## 엑셀 내장 날짜함수 사용

```excel
= IF( MONTH( DATE( 연도, 2, 29 )) = 2, "윤년", "평년" )
```
{:.excel}

어떤 `연도`의 2월 29일이 실제로 존재하는지를 판단하는 방식이다. 윤년이 아니라면 `MONTH( DATE( 연도, 2, 29 ))` 의 결과는 3 이 되어 함수식 결과는 평년이 된다.

이 수식은 두가지 문제가 있다. 첫번째 문제는 날짜를 1900년부터 9999년까지만 인식한다는 점이다.

두번째 문제가 더 큰 문제인데, **엑셀에는 1900 년을 윤년이 아님에도 윤년으로 판단하는 버그**가 있다. 1900년은 실제로 윤년이 아님에도 윤년으로 인식이다. 일부러 유지하는 버그인데 [MS 도움말](https://docs.microsoft.com/ko-KR/office/troubleshoot/excel/wrongly-assumes-1900-is-leap-year)을 참고하자면, 엑셀 이전의 소프트웨어들과 호환성을 유지하기 위해 당시 소프트웨어가 안고 있던 버그도 그대로 수용했다고 한다.