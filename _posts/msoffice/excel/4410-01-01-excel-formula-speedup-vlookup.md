---
layout: default
title: "VLOOKUP: 유사일치 방식으로 VLOOKUP 함수 속도 높이기"
updated: 2022-03-27
tags: [msoffice,formula]
---

## 속도개선 VLOOKUP 함수식

![그림00]({{ '/img/msoffice/formula-0000.png' | relative_url }})

```excel
= IF( 검색값=VLOOKUP( 검색값, 검색범위, 1, TRUE ), VLOOKUP( 검색값, 검색범위, 열번호, TRUE ), NA())
```
{:.excel}

VLOOKUP 함수의 4 번째 인수에 TRUE 값을 지정하였다. 이는 "정확한일치" 가 아닌 "유사일치" 방식으로 VLOOKUP 함수를 사용한다는 의미다. "유사일치" 방식이 적용되면, `검색범위`의 첫부분부터 순차적으로 `검색값`을 찾지 않고, "이진탐색" 알고리즘을 사용하여 `검색값`을 찾는다.

이진탐색이 유효하게 성립하려면, 검색기준열에 해당되는 **`검색범위`의 가장 왼쪽열은 반드시 오름차순으로 정렬** 이 되어있어야 한다. 따라서, `검색범위`에 새로운 데이터가 추가 될 때마다 다시금 정렬을 해줘야 한다.

## 함수식 이해

이진탐색이 무엇인지 알아야 왜 이 함수식이 매우 빠른 검색속도를 보이는지 알 수 있다. [이진탐색](https://namu.wiki/w/%EC%9D%B4%EC%A7%84%20%ED%83%90%EC%83%89) 링크로 들어가 그림을 참고하면 알고리즘 원리가 바로 이해될 것이다. 또한 검색기준열이 왜 오름차순으로 정렬이 되어있어야하는지도 알 수 있다.

간단하게 설명하자면, 10,000 개의 데이터가 나열되어 있을 때, "정확한일치" 방식의 검색은 순차적으로 검색을 진행하기 때문에 최대 10,000 번의 검색을 수행하게 된다. 하지만 "유사일치" 로 이진탐색 알고리즘을 사용하면 최대 15 번의 검색만으로 `검색값`을 찾을 수 있다.

다만 VLOOKUP 의 "유사일치" 옵션은 `검색값` 을 못찾았을 경우 바로 그 직전의 값을 가리킨다. 위 함수식은 "정확한일치"와 유사하게 작동하도록, 정확한 `검색값`이 아니라면 NA 함수를 사용하도록 꾸며져있다.