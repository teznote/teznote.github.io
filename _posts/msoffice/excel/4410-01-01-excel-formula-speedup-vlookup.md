---
layout: post
title: "VLOOKUP: 유사일치 방식으로 VLOOKUP 함수 속도 높이기"
updated: 2024-04-22
categories: [excel_formula]
tags: [msoffice,excel,formula,vlookup,if,na]
---

## 속도개선 VLOOKUP 함수식

![그림00]({{ '/img/msoffice/formula-4410.png' | relative_url }})

```excel
= IF( 검색값=VLOOKUP( 검색값, 검색범위, 1, TRUE ), VLOOKUP( 검색값, 검색범위, 열번호, TRUE ), NA())
```
{:.excel}

VLOOKUP 함수의 4 번째 인수에 TRUE 값을 지정하여 "유사일치" 방식으로 VLOOKUP 함수를 사용하였다. "유사일치" 방식이 적용되면, `검색범위`의 첫부분부터 순차적으로 `검색값`을 찾지 않고, [이진탐색](https://namu.wiki/w/%EC%9D%B4%EC%A7%84%20%ED%83%90%EC%83%89) 알고리즘을 사용하여 `검색값`을 찾는다.

이진탐색이 유효하게 성립하려면, 검색기준열에 해당되는 **`검색범위`의 가장 왼쪽열은 반드시 오름차순으로 정렬** 이 되어있어야 한다. 따라서, `검색범위`에 새로운 데이터가 추가 될 때마다 반드시 정렬을 새로 해줘야 한다.

## 함수식 이해

이진탐색은 이른바 영어사전에서 단어를 검색하는 것과 유사하다. 예를들어 P 로 시작하는 단어를 찾아볼 때는 사전 첫부분부터 찾아보지 않는다. 적당히 P 가 있을법한 위치를 펼치고, 찾고자 하는 단어가 없다면 보다 앞장에있을지 아니면 뒷장에있을지를 판단하여 다시 사전 페이지를 넘기게 된다. 그래서 `검색범위`가 오름차순으로 정렬이 되어있어야 하며, 검색 속도가 빠를 수밖에 없다.

또한 VLOOKUP 의 "유사일치" 옵션은 `검색값` 을 못찾았을 경우 바로 그 직전의 값을 가리키므로 위 함수식은 "정확한일치"와 유사하게 작동하도록, 정확한 `검색값`이 아니라면 NA 함수를 사용하도록 꾸며져있다.